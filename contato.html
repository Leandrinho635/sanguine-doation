<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fale conosco - Doe Sangue</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&family=Roboto&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="stylesheet" href="contato.css">
</head>

<body>
    <!-- ===== CABE√áALHO COM IMAGEM DE FUNDO ===== -->
    <header>
        <h1>Fale conosco</h1>

        <!-- Bot√£o voltar para homepage -->
        <a href="index.html" class="voltar-home">
            <i class="fas fa-tint fa-2x"></i>
            <span>Homepage</span>
        </a>

        <!-- Navega√ß√£o -->
        <nav class="navegacao-contato">
            <menu>
                <ul><a href="orientacoes.html">Orienta√ß√µes</a></ul>
                <ul><a href="porque.html">Por que doar sangue?</a></ul>
                <ul><a href="sobre-nos.html">Sobre n√≥s</a></ul>
                <ul><a href="contato.html">Fale conosco</a></ul>
            </menu>
        </nav>

        <!-- T√≠tulo do banner -->
        <h1 class="titulo-banner">Fa√ßa sua parte e contribua!</h1>
    </header>

    <!-- ===== CONTE√öDO PRINCIPAL ===== -->
    <div class="conteudo-principal">

        <!-- Introdu√ß√£o -->
        <div class="introducao">
            <h2><i class="fas fa-envelope"></i> Entre em contato</h2>
            <p>
                Tem d√∫vidas, sugest√µes ou quer saber mais sobre doa√ß√£o de sangue?
                Preencha o formul√°rio abaixo e entraremos em contato o mais breve poss√≠vel!
            </p>
        </div>

        <div class="container">
            <h1>ü©∏ Quero Doar Sangue</h1>
            <p class="subtitle">Preencha o formul√°rio e entraremos em contato</p>
            
            <div id="message" class="message"></div>
            
            <form id="doadorForm">
                <div class="form-group">
                    <label for="nome">Nome Completo *</label>
                    <input type="text" id="nome" name="nome" required>
                </div>
                
                <div class="form-group">
                    <label for="email">E-mail *</label>
                    <input type="email" id="email" name="email" required>
                </div>
                
                <div class="form-group">
                    <label for="telefone">Telefone/WhatsApp *</label>
                    <input type="tel" id="telefone" name="telefone" placeholder="(11) 98765-4321" required>
                </div>
                
                <div class="form-group">
                    <label for="tipo_sanguineo">Tipo Sangu√≠neo</label>
                    <select id="tipo_sanguineo" name="tipo_sanguineo">
                        <option value="">Selecione (opcional)</option>
                        <option value="A+">A+</option>
                        <option value="A-">A-</option>
                        <option value="B+">B+</option>
                        <option value="B-">B-</option>
                        <option value="AB+">AB+</option>
                        <option value="AB-">AB-</option>
                        <option value="O+">O+</option>
                        <option value="O-">O-</option>
                        <option value="N√£o sei">N√£o sei</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="cidade">Cidade *</label>
                    <input type="text" id="cidade" name="cidade" required>
                </div>
                
                <div class="form-group">
                    <label for="mensagem">Mensagem (opcional)</label>
                    <textarea id="mensagem" name="mensagem" placeholder="Conte-nos mais sobre seu interesse em doar..."></textarea>
                </div>
                
                <button type="submit" class="btn-submit" id="submitBtn">
                    Enviar Cadastro
                </button>
            </form>
        </div>

    </div>

    <!-- ===== RODAP√â ===== -->
    <footer>
        <i class="fas fa-tint"></i> Doe Sangue, Salve Vidas
        <br>
        &copy; 2024 Doe Sangue - Projeto UFSC. Todos os direitos reservados.
    </footer>

    <!-- ===== SCRIPTS ===== -->
    <!-- Supabase JS Client -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <script>
        // SUBSTITUA ESTAS CREDENCIAIS PELAS SUAS DO SUPABASE
        const SUPABASE_URL = 'https://gjqusvaayaxbdltzoesx.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdqcXVzdmFheWF4YmRsdHpvZXN4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQxOTQ0NjQsImV4cCI6MjA3OTc3MDQ2NH0.0Q2388WW7QLS9ui5uuxAq4OGRD_kQ_A1GVCzqG_L3NM';
        
        // Inicializar o cliente Supabase
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
        
        // Elementos do DOM
        const form = document.getElementById('doadorForm');
        const submitBtn = document.getElementById('submitBtn');
        const messageDiv = document.getElementById('message');
        
        // Fun√ß√£o para mostrar mensagens
        function showMessage(text, type) {
            messageDiv.textContent = text;
            messageDiv.className = `message ${type}`;
            messageDiv.style.display = 'block';
            
            // Scroll suave at√© a mensagem
            messageDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            
            // Esconder mensagem ap√≥s 5 segundos
            setTimeout(() => {
                messageDiv.style.display = 'none';
            }, 5000);
        }
        
        // Handler do formul√°rio
        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            // Desabilitar bot√£o durante envio
            submitBtn.disabled = true;
            submitBtn.textContent = 'Enviando...';
            
            // Coletar dados do formul√°rio
            const formData = {
                nome: document.getElementById('nome').value,
                email: document.getElementById('email').value,
                telefone: document.getElementById('telefone').value,
                tipo_sanguineo: document.getElementById('tipo_sanguineo').value || null,
                cidade: document.getElementById('cidade').value,
                mensagem: document.getElementById('mensagem').value || null
            };
            
            try {
                // Inserir dados no Supabase
                const { data, error } = await supabase
                    .from('doadores')
                    .insert([formData]);
                
                if (error) throw error;
                
                // Sucesso
                showMessage('‚úÖ Cadastro realizado com sucesso! Entraremos em contato em breve.', 'success');
                form.reset();
                
            } catch (error) {
                console.error('Erro ao cadastrar:', error);
                showMessage('‚ùå Erro ao enviar cadastro. Por favor, tente novamente.', 'error');
            } finally {
                // Reabilitar bot√£o
                submitBtn.disabled = false;
                submitBtn.textContent = 'Enviar Cadastro';
            }
        });

        // Anima√ß√£o dos cards ao entrar na viewport
        document.addEventListener('DOMContentLoaded', function () {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach((entry, index) => {
                    if (entry.isIntersecting) {
                        setTimeout(() => {
                            entry.target.style.opacity = '1';
                            entry.target.style.transform = 'translateY(0)';
                        }, index * 100);
                    }
                });
            }, { threshold: 0.1 });

            // Prepara e observa os cards
            document.querySelectorAll('.info-card, .faq-item').forEach(card => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(20px)';
                card.style.transition = 'all 0.6s ease-out';
                observer.observe(card);
            });
        });

        // M√°scara para telefone
        document.getElementById('telefone').addEventListener('input', function (e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length > 11) value = value.slice(0, 11);

            if (value.length > 10) {
                value = value.replace(/^(\d{2})(\d{5})(\d{4})/, '($1) $2-$3');
            } else if (value.length > 6) {
                value = value.replace(/^(\d{2})(\d{4})(\d{0,4})/, '($1) $2-$3');
            } else if (value.length > 2) {
                value = value.replace(/^(\d{2})(\d{0,5})/, '($1) $2');
            } else {
                value = value.replace(/^(\d*)/, '($1');
            }

            e.target.value = value;
        });
    </script>
</body>

</html>
